package org.dao;

import java.util.Collection;


import javax.ejb.Remote;
import javax.ejb.Stateless;
import javax.persistence.EntityManager;

import javax.persistence.Query;
import org.entitees.Produit;


@Stateless
@Remote(ProduitInterface.class)
public class ProduitImpl implements ProduitInterface {

	//private static final Logger log = Logger.getLogger(ProduitInterface.class);
	
	//@EJB CategorieImpl Categoriedao;
	@PersistenceContext(unitName="Persist")
	private EntityManager em;
	Produit produit;
	
	public Long ajouterProduit(Produit p) {
		em.persist(p);
		return p.getIdProduit();
	}
    
 	public Collection<Produit> getListeProduit(){
		//log.debug("Begin getListeProduit");
 		try {
 			Query req = em.createQuery("SELECT p FROM Produit p");
 			return req.getResultList();
		} catch (Exception ex) {
			throw ex;
		}
		//log.debug("End getListeProduit");
	}
	
	public Collection<Produit> getListeProduitParNom(String nomProduit){
		Query req = em.createQuery("SELECT p FROM Produit p WHERE p.NOMPRODUIT like :x");
		//Query req = em.createQuery("SELECT p FROM Produit p WHERE NOMPRODUIT like 'Ordinateur'");
		req.setParameter("x", nomProduit);
		//Query req = em.createQuery("SELECT p FROM Produit p");
		return req.getResultList();
	}
	
	public Produit getProduitParId(Long idProduit){
		Query req = em.createQuery("SELECT p FROM Produit p WHERE p.idProduit like :x ");
		req.setParameter("x", "%"+idProduit+"%");
		return (Produit) req.getResultList();
	}

	public Collection<Produit> getListProduitParIdCategorie(Long idCategorie){
		Query req = em.createQuery("SELECT p FROM Produit p WHERE p.idCategorie like :x ");
		req.setParameter("x", "%"+idCategorie+"%");
		return req.getResultList();
		
		//return (Collection<Produit>) em.createNamedQuery("Produit.findByidCategorie").setParameter("idCatgorie", idCategorie).getResultList();
	}
	
	public String bidon()
	{
		return "bidon bdio";
	}

}

package org.dao;

import javax.ejb.Remote;
import javax.ejb.Stateless;
import javax.persistence.EntityManager;
import javax.persistence.PersistenceContext;

import org.entitees.Commande;
import org.entitees.LigneCommande;
import org.entitees.Produit;

@Stateless
@Remote(CommandeInterface.class)
public class CommandeImpl implements CommandeInterface {
	
	@PersistenceContext(unitName="Persist")
	private EntityManager em;

	public void executeCommande(Commande cmd) {
		em.persist(cmd);
	}

	int lcmdID = 0;
	public Commande cmd;
	public LigneCommande ligneCommande;
	
	public Commande addCommandeAndLineCommande(Produit produit, int quantite, double prix) {

		if (ligneCommande == null || ligneCommande.isEmpty()){
			ligneCommande = new ArrayList<LigneCommande>();
		}
		LigneCommande lcmd = new LigneCommande();
		lcmd.setIdLigneCommande(lcmdID);
		lcmd.setProduit(produit);
		lcmd.setQuantiteProduit(quantite);
		lcmd.setPrix(quantite * prix);
		ligneCommande.add(lcmd);
		montantCommande += quantite * prix ;
		cmdID = lcmdID + 1;
		return lcmd;
	}

	



}
